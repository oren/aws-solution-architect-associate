"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const construct_1 = require("../core/construct");
const fn_1 = require("./fn");
const stack_1 = require("./stack");
class Output extends stack_1.StackElement {
    /**
     * Creates an Output value for this stack.
     * @param parent The parent construct.
     * @param props Output properties.
     */
    constructor(parent, name, props = {}) {
        super(parent, name);
        this.description = props.description;
        this.value = props.value;
        this.condition = props.condition;
        if (props.export) {
            if (props.disableExport) {
                throw new Error('Cannot set `disableExport` and specify an export name');
            }
            this.export = props.export;
        }
        else if (!props.disableExport) {
            // prefix export name with stack name since exports are global within account + region.
            const stackName = stack_1.Stack.find(this).id;
            this.export = stackName ? stackName + ':' : '';
            this.export += this.logicalId;
        }
    }
    /**
     * Returns an FnImportValue bound to this export name.
     */
    makeImportValue() {
        if (!this.export) {
            throw new Error('Cannot create an ImportValue without an export name');
        }
        return new fn_1.FnImportValue(this.export);
    }
    toCloudFormation() {
        return {
            Outputs: {
                [this.logicalId]: {
                    Description: this.description,
                    Value: this.value,
                    Export: this.export != null ? { Name: this.export } : undefined,
                    Condition: this.condition ? this.condition.logicalId : undefined
                }
            }
        };
    }
    get ref() {
        throw new Error('Outputs cannot be referenced');
    }
}
exports.Output = Output;
/**
 * An output for a list of strings.
 *
 * Exports a list of Tokens via an Output variable, and return a list of Tokens
 * that selects the imported values for them.
 */
class StringListOutput extends construct_1.Construct {
    constructor(parent, name, props) {
        super(parent, name);
        this.separator = props.separator || ',';
        this.length = props.values.length;
        this.output = new Output(this, 'Resource', {
            description: props.description,
            condition: props.condition,
            disableExport: props.disableExport,
            export: props.export,
            value: new fn_1.FnJoin(this.separator, props.values)
        });
    }
    /**
     * Return an array of imported values for this Output
     */
    makeImportValues() {
        const combined = this.output.makeImportValue();
        const ret = [];
        for (let i = 0; i < this.length; i++) {
            ret.push(new fn_1.FnSelect(i, new fn_1.FnSplit(this.separator, combined)));
        }
        return ret;
    }
}
exports.StringListOutput = StringListOutput;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib3V0cHV0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsib3V0cHV0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsaURBQThDO0FBRzlDLDZCQUFnRTtBQUNoRSxtQ0FBOEM7QUEyQzlDLE1BQWEsTUFBTyxTQUFRLG9CQUFZO0lBMkJ0Qzs7OztPQUlHO0lBQ0gsWUFBWSxNQUFpQixFQUFFLElBQVksRUFBRSxRQUFxQixFQUFFO1FBQ2xFLEtBQUssQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFFcEIsSUFBSSxDQUFDLFdBQVcsR0FBRyxLQUFLLENBQUMsV0FBVyxDQUFDO1FBQ3JDLElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQztRQUN6QixJQUFJLENBQUMsU0FBUyxHQUFHLEtBQUssQ0FBQyxTQUFTLENBQUM7UUFFakMsSUFBSSxLQUFLLENBQUMsTUFBTSxFQUFFO1lBQ2hCLElBQUksS0FBSyxDQUFDLGFBQWEsRUFBRTtnQkFDdkIsTUFBTSxJQUFJLEtBQUssQ0FBQyx1REFBdUQsQ0FBQyxDQUFDO2FBQzFFO1lBQ0QsSUFBSSxDQUFDLE1BQU0sR0FBRyxLQUFLLENBQUMsTUFBTSxDQUFDO1NBQzVCO2FBQU0sSUFBSSxDQUFDLEtBQUssQ0FBQyxhQUFhLEVBQUU7WUFDL0IsdUZBQXVGO1lBQ3ZGLE1BQU0sU0FBUyxHQUFHLGFBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsRUFBRSxDQUFDO1lBQ3RDLElBQUksQ0FBQyxNQUFNLEdBQUcsU0FBUyxDQUFDLENBQUMsQ0FBQyxTQUFTLEdBQUcsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7WUFDL0MsSUFBSSxDQUFDLE1BQU0sSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDO1NBQy9CO0lBQ0gsQ0FBQztJQUVEOztPQUVHO0lBQ0ksZUFBZTtRQUNwQixJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRTtZQUNoQixNQUFNLElBQUksS0FBSyxDQUFDLHFEQUFxRCxDQUFDLENBQUM7U0FDeEU7UUFDRCxPQUFPLElBQUksa0JBQWEsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDeEMsQ0FBQztJQUVNLGdCQUFnQjtRQUNyQixPQUFPO1lBQ0wsT0FBTyxFQUFFO2dCQUNQLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxFQUFFO29CQUNoQixXQUFXLEVBQUUsSUFBSSxDQUFDLFdBQVc7b0JBQzdCLEtBQUssRUFBRSxJQUFJLENBQUMsS0FBSztvQkFDakIsTUFBTSxFQUFFLElBQUksQ0FBQyxNQUFNLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQyxDQUFDLFNBQVM7b0JBQy9ELFNBQVMsRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsU0FBUztpQkFDakU7YUFDRjtTQUNGLENBQUM7SUFDSixDQUFDO0lBRUQsSUFBVyxHQUFHO1FBQ1osTUFBTSxJQUFJLEtBQUssQ0FBQyw4QkFBOEIsQ0FBQyxDQUFDO0lBQ2xELENBQUM7Q0FDRjtBQTlFRCx3QkE4RUM7QUFtREQ7Ozs7O0dBS0c7QUFDSCxNQUFhLGdCQUFpQixTQUFRLHFCQUFTO0lBZ0I3QyxZQUFZLE1BQWlCLEVBQUUsSUFBWSxFQUFFLEtBQTRCO1FBQ3ZFLEtBQUssQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFFcEIsSUFBSSxDQUFDLFNBQVMsR0FBRyxLQUFLLENBQUMsU0FBUyxJQUFJLEdBQUcsQ0FBQztRQUN4QyxJQUFJLENBQUMsTUFBTSxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDO1FBRWxDLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxNQUFNLENBQUMsSUFBSSxFQUFFLFVBQVUsRUFBRTtZQUN6QyxXQUFXLEVBQUUsS0FBSyxDQUFDLFdBQVc7WUFDOUIsU0FBUyxFQUFFLEtBQUssQ0FBQyxTQUFTO1lBQzFCLGFBQWEsRUFBRSxLQUFLLENBQUMsYUFBYTtZQUNsQyxNQUFNLEVBQUUsS0FBSyxDQUFDLE1BQU07WUFDcEIsS0FBSyxFQUFFLElBQUksV0FBTSxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsS0FBSyxDQUFDLE1BQU0sQ0FBQztTQUNoRCxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQ7O09BRUc7SUFDSSxnQkFBZ0I7UUFDckIsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxlQUFlLEVBQUUsQ0FBQztRQUUvQyxNQUFNLEdBQUcsR0FBRyxFQUFFLENBQUM7UUFDZixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtZQUNwQyxHQUFHLENBQUMsSUFBSSxDQUFDLElBQUksYUFBUSxDQUFDLENBQUMsRUFBRSxJQUFJLFlBQU8sQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUNsRTtRQUVELE9BQU8sR0FBRyxDQUFDO0lBQ2IsQ0FBQztDQUNGO0FBNUNELDRDQTRDQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbnN0cnVjdCB9IGZyb20gJy4uL2NvcmUvY29uc3RydWN0JztcbmltcG9ydCB7IFRva2VuIH0gZnJvbSAnLi4vY29yZS90b2tlbnMnO1xuaW1wb3J0IHsgQ29uZGl0aW9uIH0gZnJvbSAnLi9jb25kaXRpb24nO1xuaW1wb3J0IHsgRm5JbXBvcnRWYWx1ZSwgRm5Kb2luLCBGblNlbGVjdCwgRm5TcGxpdCB9IGZyb20gJy4vZm4nO1xuaW1wb3J0IHsgU3RhY2ssIFN0YWNrRWxlbWVudCB9IGZyb20gJy4vc3RhY2snO1xuXG5leHBvcnQgaW50ZXJmYWNlIE91dHB1dFByb3BzIHtcbiAgLyoqXG4gICAqIEEgU3RyaW5nIHR5cGUgdGhhdCBkZXNjcmliZXMgdGhlIG91dHB1dCB2YWx1ZS5cbiAgICogVGhlIGRlc2NyaXB0aW9uIGNhbiBiZSBhIG1heGltdW0gb2YgNCBLIGluIGxlbmd0aC5cbiAgICovXG4gIGRlc2NyaXB0aW9uPzogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUaGUgdmFsdWUgb2YgdGhlIHByb3BlcnR5IHJldHVybmVkIGJ5IHRoZSBhd3MgY2xvdWRmb3JtYXRpb24gZGVzY3JpYmUtc3RhY2tzIGNvbW1hbmQuXG4gICAqIFRoZSB2YWx1ZSBvZiBhbiBvdXRwdXQgY2FuIGluY2x1ZGUgbGl0ZXJhbHMsIHBhcmFtZXRlciByZWZlcmVuY2VzLCBwc2V1ZG8tcGFyYW1ldGVycyxcbiAgICogYSBtYXBwaW5nIHZhbHVlLCBvciBpbnRyaW5zaWMgZnVuY3Rpb25zLlxuICAgKi9cbiAgdmFsdWU/OiBhbnk7XG5cbiAgLyoqXG4gICAqIFRoZSBuYW1lIHVzZWQgdG8gZXhwb3J0IHRoZSB2YWx1ZSBvZiB0aGlzIG91dHB1dCBhY3Jvc3Mgc3RhY2tzLiBUbyBpbXBvcnRcbiAgICogdGhlIHZhbHVlIGZyb20gYW5vdGhlciBzdGFjaywgdXNlIGBGbkltcG9ydFZhbHVlKGV4cG9ydClgLiBZb3UgY2FuIGNyZWF0ZVxuICAgKiBhbiBpbXBvcnQgdmFsdWUgdG9rZW4gYnkgY2FsbGluZyBgb3V0cHV0Lm1ha2VJbXBvcnRWYWx1ZSgpYC5cbiAgICpcbiAgICogQGRlZmF1bHQgVGhlIGRlZmF1bHQgYmVoYXZpb3IgaXMgdG8gYXV0b21hdGljYWxseSBhbGxvY2F0ZSBhbiBleHBvcnQgbmFtZVxuICAgKiBmb3Igb3V0cHV0cyBiYXNlZCBvbiB0aGUgc3RhY2sgbmFtZSBhbmQgdGhlIG91dHB1dCdzIGxvZ2ljYWwgSUQuIFRvXG4gICAqIGNyZWF0ZSBhbiBvdXRwdXQgd2l0aG91dCBhbiBleHBvcnQsIHNldCBgZGlzYWJsZUV4cG9ydDogdHJ1ZWAuXG4gICAqL1xuICBleHBvcnQ/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIERpc2FibGVzIHRoZSBhdXRvbWF0aWMgYWxsb2NhdGlvbiBvZiBhbiBleHBvcnQgbmFtZSBmb3IgdGhpcyBvdXRwdXQuXG4gICAqXG4gICAqIEBkZWZhdWx0IGZhbHNlLCB3aGljaCBtZWFucyB0aGF0IGFuIGV4cG9ydCBuYW1lIGlzIGVpdGhlciBleHBsaWNpdGx5XG4gICAqIHNwZWNpZmllZCBvciBhbGxvY2F0ZWQgYmFzZWQgb24gdGhlIG91dHB1dCdzIGxvZ2ljYWwgSUQgYW5kIHN0YWNrIG5hbWUuXG4gICAqL1xuICBkaXNhYmxlRXhwb3J0PzogYm9vbGVhbjtcblxuICAvKipcbiAgICogQSBjb25kaXRpb24gZnJvbSB0aGUgXCJDb25kaXRpb25zXCIgc2VjdGlvbiB0byBhc3NvY2lhdGUgd2l0aCB0aGlzIG91dHB1dFxuICAgKiB2YWx1ZS4gSWYgdGhlIGNvbmRpdGlvbiBldmFsdWF0ZXMgdG8gYGZhbHNlYCwgdGhpcyBvdXRwdXQgdmFsdWUgd2lsbCBub3RcbiAgICogYmUgaW5jbHVkZWQgaW4gdGhlIHN0YWNrLlxuICAgKi9cbiAgY29uZGl0aW9uPzogQ29uZGl0aW9uO1xufVxuXG5leHBvcnQgY2xhc3MgT3V0cHV0IGV4dGVuZHMgU3RhY2tFbGVtZW50IHtcbiAgLyoqXG4gICAqIEEgU3RyaW5nIHR5cGUgdGhhdCBkZXNjcmliZXMgdGhlIG91dHB1dCB2YWx1ZS5cbiAgICogVGhlIGRlc2NyaXB0aW9uIGNhbiBiZSBhIG1heGltdW0gb2YgNCBLIGluIGxlbmd0aC5cbiAgICovXG4gIHB1YmxpYyByZWFkb25seSBkZXNjcmlwdGlvbj86IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIHZhbHVlIG9mIHRoZSBwcm9wZXJ0eSByZXR1cm5lZCBieSB0aGUgYXdzIGNsb3VkZm9ybWF0aW9uIGRlc2NyaWJlLXN0YWNrcyBjb21tYW5kLlxuICAgKiBUaGUgdmFsdWUgb2YgYW4gb3V0cHV0IGNhbiBpbmNsdWRlIGxpdGVyYWxzLCBwYXJhbWV0ZXIgcmVmZXJlbmNlcywgcHNldWRvLXBhcmFtZXRlcnMsXG4gICAqIGEgbWFwcGluZyB2YWx1ZSwgb3IgaW50cmluc2ljIGZ1bmN0aW9ucy5cbiAgICovXG4gIHB1YmxpYyByZWFkb25seSB2YWx1ZT86IGFueTtcblxuICAvKipcbiAgICogVGhlIG5hbWUgb2YgdGhlIHJlc291cmNlIG91dHB1dCB0byBiZSBleHBvcnRlZCBmb3IgYSBjcm9zcy1zdGFjayByZWZlcmVuY2UuXG4gICAqIEJ5IGRlZmF1bHQsIHRoZSBsb2dpY2FsIElEIG9mIHRoZSBPdXRwdXQgZWxlbWVudCBpcyB1c2VkIGFzIGl0J3MgZXhwb3J0IG5hbWUuXG4gICAqL1xuICBwdWJsaWMgcmVhZG9ubHkgZXhwb3J0Pzogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBBIGNvbmRpdGlvbiBmcm9tIHRoZSBcIkNvbmRpdGlvbnNcIiBzZWN0aW9uIHRvIGFzc29jaWF0ZSB3aXRoIHRoaXMgb3V0cHV0XG4gICAqIHZhbHVlLiBJZiB0aGUgY29uZGl0aW9uIGV2YWx1YXRlcyB0byBgZmFsc2VgLCB0aGlzIG91dHB1dCB2YWx1ZSB3aWxsIG5vdFxuICAgKiBiZSBpbmNsdWRlZCBpbiB0aGUgc3RhY2suXG4gICAqL1xuICBwdWJsaWMgcmVhZG9ubHkgY29uZGl0aW9uPzogQ29uZGl0aW9uO1xuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGFuIE91dHB1dCB2YWx1ZSBmb3IgdGhpcyBzdGFjay5cbiAgICogQHBhcmFtIHBhcmVudCBUaGUgcGFyZW50IGNvbnN0cnVjdC5cbiAgICogQHBhcmFtIHByb3BzIE91dHB1dCBwcm9wZXJ0aWVzLlxuICAgKi9cbiAgY29uc3RydWN0b3IocGFyZW50OiBDb25zdHJ1Y3QsIG5hbWU6IHN0cmluZywgcHJvcHM6IE91dHB1dFByb3BzID0ge30pIHtcbiAgICBzdXBlcihwYXJlbnQsIG5hbWUpO1xuXG4gICAgdGhpcy5kZXNjcmlwdGlvbiA9IHByb3BzLmRlc2NyaXB0aW9uO1xuICAgIHRoaXMudmFsdWUgPSBwcm9wcy52YWx1ZTtcbiAgICB0aGlzLmNvbmRpdGlvbiA9IHByb3BzLmNvbmRpdGlvbjtcblxuICAgIGlmIChwcm9wcy5leHBvcnQpIHtcbiAgICAgIGlmIChwcm9wcy5kaXNhYmxlRXhwb3J0KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IHNldCBgZGlzYWJsZUV4cG9ydGAgYW5kIHNwZWNpZnkgYW4gZXhwb3J0IG5hbWUnKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuZXhwb3J0ID0gcHJvcHMuZXhwb3J0O1xuICAgIH0gZWxzZSBpZiAoIXByb3BzLmRpc2FibGVFeHBvcnQpIHtcbiAgICAgIC8vIHByZWZpeCBleHBvcnQgbmFtZSB3aXRoIHN0YWNrIG5hbWUgc2luY2UgZXhwb3J0cyBhcmUgZ2xvYmFsIHdpdGhpbiBhY2NvdW50ICsgcmVnaW9uLlxuICAgICAgY29uc3Qgc3RhY2tOYW1lID0gU3RhY2suZmluZCh0aGlzKS5pZDtcbiAgICAgIHRoaXMuZXhwb3J0ID0gc3RhY2tOYW1lID8gc3RhY2tOYW1lICsgJzonIDogJyc7XG4gICAgICB0aGlzLmV4cG9ydCArPSB0aGlzLmxvZ2ljYWxJZDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhbiBGbkltcG9ydFZhbHVlIGJvdW5kIHRvIHRoaXMgZXhwb3J0IG5hbWUuXG4gICAqL1xuICBwdWJsaWMgbWFrZUltcG9ydFZhbHVlKCkge1xuICAgIGlmICghdGhpcy5leHBvcnQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IGNyZWF0ZSBhbiBJbXBvcnRWYWx1ZSB3aXRob3V0IGFuIGV4cG9ydCBuYW1lJyk7XG4gICAgfVxuICAgIHJldHVybiBuZXcgRm5JbXBvcnRWYWx1ZSh0aGlzLmV4cG9ydCk7XG4gIH1cblxuICBwdWJsaWMgdG9DbG91ZEZvcm1hdGlvbigpOiBvYmplY3Qge1xuICAgIHJldHVybiB7XG4gICAgICBPdXRwdXRzOiB7XG4gICAgICAgIFt0aGlzLmxvZ2ljYWxJZF06IHtcbiAgICAgICAgICBEZXNjcmlwdGlvbjogdGhpcy5kZXNjcmlwdGlvbixcbiAgICAgICAgICBWYWx1ZTogdGhpcy52YWx1ZSxcbiAgICAgICAgICBFeHBvcnQ6IHRoaXMuZXhwb3J0ICE9IG51bGwgPyB7IE5hbWU6IHRoaXMuZXhwb3J0IH0gOiB1bmRlZmluZWQsXG4gICAgICAgICAgQ29uZGl0aW9uOiB0aGlzLmNvbmRpdGlvbiA/IHRoaXMuY29uZGl0aW9uLmxvZ2ljYWxJZCA6IHVuZGVmaW5lZFxuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIHB1YmxpYyBnZXQgcmVmKCk6IHN0cmluZyB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdPdXRwdXRzIGNhbm5vdCBiZSByZWZlcmVuY2VkJyk7XG4gIH1cbn1cblxuLyoqXG4gKiBQcm9wZXJ0aWVzIGZvciBMaXN0T3V0cHV0XG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgU3RyaW5nTGlzdE91dHB1dFByb3BzIHtcbiAgLyoqXG4gICAqIEEgU3RyaW5nIHR5cGUgdGhhdCBkZXNjcmliZXMgdGhlIG91dHB1dCB2YWx1ZS5cbiAgICogVGhlIGRlc2NyaXB0aW9uIGNhbiBiZSBhIG1heGltdW0gb2YgNCBLIGluIGxlbmd0aC5cbiAgICovXG4gIHJlYWRvbmx5IGRlc2NyaXB0aW9uPzogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUaGUgbGlzdCBvZiBwcmltaXRpdmVzIHRvIGV4cG9ydFxuICAgKi9cbiAgcmVhZG9ubHkgdmFsdWVzOiBhbnlbXTtcblxuICAvKipcbiAgICogVGhlIHNlcGFyYXRvciB0byB1c2UgdG8gc2VwYXJhdGUgc3RyaW5naWZpZWQgdmFsdWVzXG4gICAqXG4gICAqIEBkZWZhdWx0IFwiLFwiXG4gICAqL1xuICByZWFkb25seSBzZXBhcmF0b3I/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBuYW1lIHVzZWQgdG8gZXhwb3J0IHRoZSB2YWx1ZSBvZiB0aGlzIG91dHB1dCBhY3Jvc3Mgc3RhY2tzLiBUbyBpbXBvcnRcbiAgICogdGhlIHZhbHVlIGZyb20gYW5vdGhlciBzdGFjaywgdXNlIGBGbkltcG9ydFZhbHVlKGV4cG9ydClgLiBZb3UgY2FuIGNyZWF0ZVxuICAgKiBhbiBpbXBvcnQgdmFsdWUgdG9rZW4gYnkgY2FsbGluZyBgb3V0cHV0Lm1ha2VJbXBvcnRWYWx1ZSgpYC5cbiAgICpcbiAgICogQGRlZmF1bHQgVGhlIGRlZmF1bHQgYmVoYXZpb3IgaXMgdG8gYXV0b21hdGljYWxseSBhbGxvY2F0ZSBhbiBleHBvcnQgbmFtZVxuICAgKiBmb3Igb3V0cHV0cyBiYXNlZCBvbiB0aGUgc3RhY2sgbmFtZSBhbmQgdGhlIG91dHB1dCdzIGxvZ2ljYWwgSUQuIFRvXG4gICAqIGNyZWF0ZSBhbiBvdXRwdXQgd2l0aG91dCBhbiBleHBvcnQsIHNldCBgZGlzYWJsZUV4cG9ydDogdHJ1ZWAuXG4gICAqL1xuICByZWFkb25seSBleHBvcnQ/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIERpc2FibGVzIHRoZSBhdXRvbWF0aWMgYWxsb2NhdGlvbiBvZiBhbiBleHBvcnQgbmFtZSBmb3IgdGhpcyBvdXRwdXQuXG4gICAqXG4gICAqIEBkZWZhdWx0IGZhbHNlLCB3aGljaCBtZWFucyB0aGF0IGFuIGV4cG9ydCBuYW1lIGlzIGVpdGhlciBleHBsaWNpdGx5XG4gICAqIHNwZWNpZmllZCBvciBhbGxvY2F0ZWQgYmFzZWQgb24gdGhlIG91dHB1dCdzIGxvZ2ljYWwgSUQgYW5kIHN0YWNrIG5hbWUuXG4gICAqL1xuICByZWFkb25seSBkaXNhYmxlRXhwb3J0PzogYm9vbGVhbjtcblxuICAvKipcbiAgICogQSBjb25kaXRpb24gZnJvbSB0aGUgXCJDb25kaXRpb25zXCIgc2VjdGlvbiB0byBhc3NvY2lhdGUgd2l0aCB0aGlzIG91dHB1dFxuICAgKiB2YWx1ZS4gSWYgdGhlIGNvbmRpdGlvbiBldmFsdWF0ZXMgdG8gYGZhbHNlYCwgdGhpcyBvdXRwdXQgdmFsdWUgd2lsbCBub3RcbiAgICogYmUgaW5jbHVkZWQgaW4gdGhlIHN0YWNrLlxuICAgKi9cbiAgcmVhZG9ubHkgY29uZGl0aW9uPzogQ29uZGl0aW9uO1xufVxuXG4vKipcbiAqIEFuIG91dHB1dCBmb3IgYSBsaXN0IG9mIHN0cmluZ3MuXG4gKlxuICogRXhwb3J0cyBhIGxpc3Qgb2YgVG9rZW5zIHZpYSBhbiBPdXRwdXQgdmFyaWFibGUsIGFuZCByZXR1cm4gYSBsaXN0IG9mIFRva2Vuc1xuICogdGhhdCBzZWxlY3RzIHRoZSBpbXBvcnRlZCB2YWx1ZXMgZm9yIHRoZW0uXG4gKi9cbmV4cG9ydCBjbGFzcyBTdHJpbmdMaXN0T3V0cHV0IGV4dGVuZHMgQ29uc3RydWN0IHtcbiAgLyoqXG4gICAqIE51bWJlciBvZiBlbGVtZW50cyBpbiB0aGUgc3RyaW5nbGlzdFxuICAgKi9cbiAgcHVibGljIHJlYWRvbmx5IGxlbmd0aDogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUaGUgc2VwYXJhdG9yIHVzZWQgdG8gY29tYmluZSB0aGUgc3RyaW5nIHZhbHVlc1xuICAgKi9cbiAgcHJpdmF0ZSByZWFkb25seSBzZXBhcmF0b3I6IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIE91dHB1dCBvYmplY3QgdGhhdCB3YXMgY3JlYXRlZFxuICAgKi9cbiAgcHJpdmF0ZSByZWFkb25seSBvdXRwdXQ6IE91dHB1dDtcblxuICBjb25zdHJ1Y3RvcihwYXJlbnQ6IENvbnN0cnVjdCwgbmFtZTogc3RyaW5nLCBwcm9wczogU3RyaW5nTGlzdE91dHB1dFByb3BzKSB7XG4gICAgc3VwZXIocGFyZW50LCBuYW1lKTtcblxuICAgIHRoaXMuc2VwYXJhdG9yID0gcHJvcHMuc2VwYXJhdG9yIHx8ICcsJztcbiAgICB0aGlzLmxlbmd0aCA9IHByb3BzLnZhbHVlcy5sZW5ndGg7XG5cbiAgICB0aGlzLm91dHB1dCA9IG5ldyBPdXRwdXQodGhpcywgJ1Jlc291cmNlJywge1xuICAgICAgZGVzY3JpcHRpb246IHByb3BzLmRlc2NyaXB0aW9uLFxuICAgICAgY29uZGl0aW9uOiBwcm9wcy5jb25kaXRpb24sXG4gICAgICBkaXNhYmxlRXhwb3J0OiBwcm9wcy5kaXNhYmxlRXhwb3J0LFxuICAgICAgZXhwb3J0OiBwcm9wcy5leHBvcnQsXG4gICAgICB2YWx1ZTogbmV3IEZuSm9pbih0aGlzLnNlcGFyYXRvciwgcHJvcHMudmFsdWVzKVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybiBhbiBhcnJheSBvZiBpbXBvcnRlZCB2YWx1ZXMgZm9yIHRoaXMgT3V0cHV0XG4gICAqL1xuICBwdWJsaWMgbWFrZUltcG9ydFZhbHVlcygpOiBUb2tlbltdIHtcbiAgICBjb25zdCBjb21iaW5lZCA9IHRoaXMub3V0cHV0Lm1ha2VJbXBvcnRWYWx1ZSgpO1xuXG4gICAgY29uc3QgcmV0ID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICByZXQucHVzaChuZXcgRm5TZWxlY3QoaSwgbmV3IEZuU3BsaXQodGhpcy5zZXBhcmF0b3IsIGNvbWJpbmVkKSkpO1xuICAgIH1cblxuICAgIHJldHVybiByZXQ7XG4gIH1cbn1cbiJdfQ==